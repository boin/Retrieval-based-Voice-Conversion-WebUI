services:
  rvc-base:
    build: .
    image: rvc-web:latest
    container_name: rvc-cpu
    volumes:
      - .:/app
      -  /media/ttd/TeamSpace/TTD-Space/applications/rvc-web/assets:/app/assets-remote
    ports:
      - "7865:7866"
    #command: "tail -f /dev/null"
    environment:
      - TZ=Asia/Shanghai
      - LC_ALL=zh_CN.UTF-8
      - LANG=zh_CN.UTF-8
  rvc-gpu:
    container_name: "rvc"
    extends: rvc-base
    shm_size: "16gb"
    profiles:
      - production
    ports: !override
      - "7866:7866"
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              device_ids: [ "0" ]
              capabilities: [ gpu ]
